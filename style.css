/* Effets sp√©ciaux Sharingan & corbeaux Akatsuki */
:root{
  --sharingan-duration: 5.5s;
}

.sharingan-vision{
  position:fixed;
  inset:0;
  pointer-events:none;
  opacity:0;
  transition:opacity .6s ease;
  z-index:0;
  overflow:hidden;
}

.sharingan-vision::before{
  content:"";
  position:absolute;
  inset:0;
  background:radial-gradient(circle at 20% 18%, rgba(12,0,4,.55) 0%, transparent 55%),
             radial-gradient(circle at 78% 22%, rgba(28,0,8,.45) 0%, transparent 60%),
             radial-gradient(circle at 38% 75%, rgba(10,0,6,.35) 0%, transparent 70%);
  opacity:0;
  transition:opacity .6s ease;
}

.sharingan-vision::after{
  content:"";
  position:absolute;
  inset:0;
  background:radial-gradient(circle at center, rgba(240,54,74,.14) 0%, transparent 72%);
  opacity:0;
  transition:opacity .6s ease;
}

.sharingan-vision.is-active{
  opacity:1;
}

.sharingan-vision.is-active::before,
.sharingan-vision.is-active::after{
  opacity:1;
}

.sharingan-eye{
  --eye-size:min(16vw, 180px);
  --tomoe-offset:calc(var(--eye-size) * .36);
  --tomoe-size:calc(var(--eye-size) * .18);
  --eye-top:22%;
  --eye-left:22%;
  --eye-tilt:-10deg;
  --eye-scale:.45;
  position:absolute;
  top:var(--eye-top);
  left:var(--eye-left);
  width:var(--eye-size);
  height:var(--eye-size);
  border-radius:50%;
  background:radial-gradient(circle at 48% 38%, rgba(255,118,132,.92) 0%, rgba(225,22,52,.96) 45%, rgba(18,4,10,.95) 65%, rgba(0,0,0,.95) 78%, transparent 88%);
  box-shadow:0 0 35px rgba(242,75,100,.38), inset 0 0 22px rgba(0,0,0,.82);
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  transform:translate(-50%, -50%) scale(var(--eye-scale)) rotate(var(--eye-tilt));
  transition:opacity .35s ease, transform .6s ease;
  mix-blend-mode:screen;
}

.sharingan-eye::after{
  content:"";
  position:absolute;
  inset:18%;
  border-radius:50%;
  border:2px solid rgba(0,0,0,.45);
  box-shadow:inset 0 0 20px rgba(0,0,0,.55);
  opacity:.85;
}

.sharingan-vision.is-active .sharingan-eye{
  opacity:.82;
  transform:translate(-50%, -50%) scale(calc(var(--eye-scale) * 1.65)) rotate(var(--eye-tilt));
}

.sharingan-eye .iris{
  position:absolute;
  width:48%;
  height:48%;
  background:radial-gradient(circle at center, rgba(0,0,0,.95) 0%, rgba(35,2,9,.85) 55%, transparent 80%);
  border-radius:50%;
  box-shadow:0 0 16px rgba(0,0,0,.8);
  z-index:2;
}

.sharingan-eye .pupil{
  position:absolute;
  width:22%;
  height:22%;
  border-radius:50%;
  background:#000;
  box-shadow:0 0 12px rgba(0,0,0,.9);
  z-index:3;
}

.sharingan-eye .tomoe{
  position:absolute;
  top:50%;
  left:50%;
  width:var(--tomoe-size);
  height:var(--tomoe-size);
  background:radial-gradient(circle at 40% 40%, #1a0205 0%, #060106 65%);
  border-radius:50% 50% 38% 38%;
  transform-origin:50% 150%;
  filter:drop-shadow(0 0 6px rgba(0,0,0,.75));
  z-index:3;
}

.sharingan-eye .tomoe::after{
  content:"";
  position:absolute;
  bottom:-48%;
  left:16%;
  width:68%;
  height:68%;
  background:#060106;
  border-radius:50%;
  box-shadow:inset 0 0 6px rgba(0,0,0,.85);
}

.sharingan-eye .tomoe:nth-of-type(1){
  transform:translate(-50%, -50%) rotate(0deg) translateY(calc(var(--tomoe-offset) * -1));
}

.sharingan-eye .tomoe:nth-of-type(2){
  transform:translate(-50%, -50%) rotate(120deg) translateY(calc(var(--tomoe-offset) * -1));
}

.sharingan-eye .tomoe:nth-of-type(3){
  transform:translate(-50%, -50%) rotate(240deg) translateY(calc(var(--tomoe-offset) * -1));
}

.sharingan-vision .ring{
  position:absolute;
  inset:12%;
  border-radius:50%;
  border:2px solid rgba(0,0,0,.75);
  box-shadow:0 0 0 2px rgba(0,0,0,.6), inset 0 0 22px rgba(0,0,0,.4);
  opacity:.85;
  z-index:1;
}

.sharingan-vision .ring::after{
  content:"";
  position:absolute;
  inset:-6%;
  border-radius:50%;
  border:1px dashed rgba(0,0,0,.55);
}

.sharingan-crow{
  position:fixed;
  left:var(--start-x, -12vw);
  top:var(--start-y, 50vh);
  width:calc(42px * var(--crow-scale, 1));
  height:calc(26px * var(--crow-scale, 1));
  color:#02030a;
  opacity:0;
  transform:scale(calc(.6 * var(--crow-scale, 1)));
  filter:drop-shadow(0 6px 10px rgba(0,0,0,.7));
  animation:none;
  z-index:0;
}

.sharingan-crow::before,
.sharingan-crow::after{
  content:"";
  position:absolute;
  background:currentColor;
}

.sharingan-crow::before{
  inset:28% 18% 22% 18%;
  border-radius:50% 50% 60% 60%;
}

.sharingan-crow::after{
  inset:38% 0 36% 0;
  border-radius:50% 50% 10% 10%;
  transform:skewX(-16deg);
}

.sharingan-crow .wing{
  position:absolute;
  top:18%;
  width:70%;
  height:55%;
  background:currentColor;
  border-radius:60% 10% 70% 10%;
  transform-origin:0% 50%;
  animation:wing-flap .5s ease-in-out infinite alternate;
}

.sharingan-crow .wing:nth-child(1){
  left:-6%;
  transform:scaleX(-1);
}

.sharingan-crow .wing:nth-child(2){
  right:-6%;
}

.sharingan-vision.is-active .sharingan-crow{
  animation:crow-flight var(--crow-duration, 5.8s) ease-out forwards;
  animation-delay:var(--crow-delay, 0s);
}

@keyframes crow-flight{
  0%{opacity:0; transform:translate3d(0,0,0) scale(calc(.6 * var(--crow-scale, 1)));}
  12%{opacity:.9;}
  85%{opacity:.85;}
  100%{opacity:0; transform:translate3d(var(--dx, 110vw), var(--dy, -20vh), 0) scale(calc(1.1 * var(--crow-scale, 1)));}
}

@keyframes wing-flap{
  from{transform:rotate(-6deg);}
  to{transform:rotate(12deg);}
}

@media (max-width:720px){
  .sharingan-eye{
    --eye-size:min(42vw, 160px);
    --eye-scale:.38;
  }
}

@media print, (prefers-reduced-motion: reduce){
  .sharingan-vision{display:none !important;}
}
