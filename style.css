/* Effets spéciaux Sharingan & corbeaux Akatsuki */
:root{
  --sharingan-duration: 5.5s;
}

.sharingan-vision{
  position:fixed;
  inset:0;
  pointer-events:none;
  opacity:0;
  transition:opacity .6s ease;
  z-index:0;
  overflow:hidden;
}

.sharingan-vision::before{
  content:"";
  position:absolute;
  inset:0;
  background:radial-gradient(circle at 20% 18%, rgba(12,0,4,.55) 0%, transparent 55%),
             radial-gradient(circle at 78% 22%, rgba(28,0,8,.45) 0%, transparent 60%),
             radial-gradient(circle at 38% 75%, rgba(10,0,6,.35) 0%, transparent 70%);
  opacity:0;
  transition:opacity .6s ease;
}

.sharingan-vision::after{
  content:"";
  position:absolute;
  inset:0;
  background:radial-gradient(circle at center, rgba(240,54,74,.14) 0%, transparent 72%);
  opacity:0;
  transition:opacity .6s ease;
}

.sharingan-vision.is-active{
  opacity:1;
}

.sharingan-vision.is-active::before,
.sharingan-vision.is-active::after{
  opacity:1;
}

.sharingan-eye{
  --eye-size:min(16vw, 180px);
  --tomoe-offset:calc(var(--eye-size) * .36);
  --tomoe-size:calc(var(--eye-size) * .18);
  --eye-top:22%;
  --eye-left:22%;
  --eye-tilt:-10deg;
  --eye-scale:.45;
  position:absolute;
  top:var(--eye-top);
  left:var(--eye-left);
  width:var(--eye-size);
  height:var(--eye-size);
  border-radius:50%;
  background:radial-gradient(circle at 48% 38%, rgba(255,118,132,.92) 0%, rgba(225,22,52,.96) 45%, rgba(18,4,10,.95) 65%, rgba(0,0,0,.95) 78%, transparent 88%);
  box-shadow:0 0 35px rgba(242,75,100,.38), inset 0 0 22px rgba(0,0,0,.82);
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  transform:translate(-50%, -50%) scale(var(--eye-scale)) rotate(var(--eye-tilt));
  transition:opacity .35s ease, transform .6s ease;
  mix-blend-mode:screen;
}

.sharingan-eye::after{
  content:"";
  position:absolute;
  inset:18%;
  border-radius:50%;
  border:2px solid rgba(0,0,0,.45);
  box-shadow:inset 0 0 20px rgba(0,0,0,.55);
  opacity:.85;
}

.sharingan-vision.is-active .sharingan-eye{
  opacity:.82;
  transform:translate(-50%, -50%) scale(calc(var(--eye-scale) * 1.65)) rotate(var(--eye-tilt));
}

.sharingan-eye .iris{
  position:absolute;
  width:48%;
  height:48%;
  background:radial-gradient(circle at center, rgba(0,0,0,.95) 0%, rgba(35,2,9,.85) 55%, transparent 80%);
  border-radius:50%;
  box-shadow:0 0 16px rgba(0,0,0,.8);
  z-index:2;
}

.sharingan-eye .pupil{
  position:absolute;
  width:22%;
  height:22%;
  border-radius:50%;
  background:#000;
  box-shadow:0 0 12px rgba(0,0,0,.9);
  z-index:3;
}

.sharingan-eye .tomoe{
  position:absolute;
  top:50%;
  left:50%;
  width:var(--tomoe-size);
  height:var(--tomoe-size);
  background:radial-gradient(circle at 40% 40%, #1a0205 0%, #060106 65%);
  border-radius:50% 50% 38% 38%;
  transform-origin:50% 150%;
  filter:drop-shadow(0 0 6px rgba(0,0,0,.75));
  z-index:3;
}

.sharingan-eye .tomoe::after{
  content:"";
  position:absolute;
  bottom:-48%;
  left:16%;
  width:68%;
  height:68%;
  background:#060106;
  border-radius:50%;
  box-shadow:inset 0 0 6px rgba(0,0,0,.85);
}

.sharingan-eye .tomoe:nth-of-type(1){
  transform:translate(-50%, -50%) rotate(0deg) translateY(calc(var(--tomoe-offset) * -1));
}

.sharingan-eye .tomoe:nth-of-type(2){
  transform:translate(-50%, -50%) rotate(120deg) translateY(calc(var(--tomoe-offset) * -1));
}

.sharingan-eye .tomoe:nth-of-type(3){
  transform:translate(-50%, -50%) rotate(240deg) translateY(calc(var(--tomoe-offset) * -1));
}

.sharingan-vision .ring{
  position:absolute;
  inset:12%;
  border-radius:50%;
  border:2px solid rgba(0,0,0,.75);
  box-shadow:0 0 0 2px rgba(0,0,0,.6), inset 0 0 22px rgba(0,0,0,.4);
  opacity:.85;
  z-index:1;
}

.sharingan-vision .ring::after{
  content:"";
  position:absolute;
  inset:-6%;
  border-radius:50%;
  border:1px dashed rgba(0,0,0,.55);
}

.sharingan-crow{
  position:fixed;
  left:var(--start-x, -12vw);
  top:var(--start-y, 50vh);
  width:calc(42px * var(--crow-scale, 1));
  height:calc(26px * var(--crow-scale, 1));
  color:#02030a;
  opacity:0;
  transform:scale(calc(.6 * var(--crow-scale, 1)));
  filter:drop-shadow(0 6px 10px rgba(0,0,0,.7));
  animation:none;
  z-index:0;
}

.sharingan-crow::before,
.sharingan-crow::after{
  content:"";
  position:absolute;
  background:currentColor;
}

.sharingan-crow::before{
  inset:28% 18% 22% 18%;
  border-radius:50% 50% 60% 60%;
}

.sharingan-crow::after{
  inset:38% 0 36% 0;
  border-radius:50% 50% 10% 10%;
  transform:skewX(-16deg);
}

.sharingan-crow .wing{
  position:absolute;
  top:18%;
  width:70%;
  height:55%;
  background:currentColor;
  border-radius:60% 10% 70% 10%;
  transform-origin:0% 50%;
  animation:wing-flap .5s ease-in-out infinite alternate;
}

.sharingan-crow .wing:nth-child(1){
  left:-6%;
  transform:scaleX(-1);
}

.sharingan-crow .wing:nth-child(2){
  right:-6%;
}

.sharingan-vision.is-active .sharingan-crow{
  animation:crow-flight var(--crow-duration, 5.8s) ease-out forwards;
  animation-delay:var(--crow-delay, 0s);
}

@keyframes crow-flight{
  0%{opacity:0; transform:translate3d(0,0,0) scale(calc(.6 * var(--crow-scale, 1)));}
  12%{opacity:.9;}
  85%{opacity:.85;}
  100%{opacity:0; transform:translate3d(var(--dx, 110vw), var(--dy, -20vh), 0) scale(calc(1.1 * var(--crow-scale, 1)));}
}

@keyframes wing-flap{
  from{transform:rotate(-6deg);}
  to{transform:rotate(12deg);}
}

/* Nuée de corbeaux Akatsuki en arrière-plan */
.akatsuki-crows{
  position:fixed;
  inset:0;
  pointer-events:none;
  overflow:hidden;
  z-index:-1;
}

.akatsuki-crow{
  --start-x:-14vw;
  --mid-x:42vw;
  --end-x:114vw;
  --drift:0vh;
  --scale:.6;
  --direction:1;
  --duration:28s;
  --delay:0s;
  --wing-speed:.9s;
  position:absolute;
  top:var(--top, 50%);
  left:0;
  width:42px;
  height:22px;
  color:rgba(6,8,12,.78);
  opacity:0;
  transform-origin:center;
  filter:drop-shadow(0 8px 12px rgba(0,0,0,.35));
  animation:akatsuki-crow-loop var(--duration) linear infinite;
  animation-delay:var(--delay);
}

html[data-theme="light"] .akatsuki-crow{
  color:rgba(86,12,22,.55);
}

.akatsuki-crow::after{
  content:"";
  position:absolute;
  inset:38% 26% 30% 26%;
  border-radius:58% 42% 60% 40%;
  background:currentColor;
  opacity:.95;
}

.akatsuki-crow__wing{
  position:absolute;
  top:18%;
  width:58%;
  height:64%;
  background:currentColor;
  border-radius:70% 12% 80% 18%;
  transform-origin:12% 58%;
  animation:akatsuki-wing var(--wing-speed) ease-in-out infinite alternate;
}

.akatsuki-crow__wing:nth-child(2){
  right:0;
  left:auto;
  transform-origin:88% 58%;
  border-radius:12% 70% 18% 80%;
  transform:scaleX(-1);
}

.akatsuki-crow::before{
  content:"";
  position:absolute;
  top:46%;
  left:30%;
  right:30%;
  height:2px;
  background:rgba(0,0,0,.25);
  filter:blur(1px);
}

@keyframes akatsuki-crow-loop{
  0%{
    opacity:0;
    transform:translate3d(var(--start-x), 0, 0) scale(var(--scale)) scaleX(var(--direction));
  }
  12%{
    opacity:.78;
  }
  48%{
    opacity:.86;
    transform:translate3d(var(--mid-x), var(--drift), 0) scale(var(--scale)) scaleX(var(--direction));
  }
  88%{
    opacity:.74;
  }
  100%{
    opacity:0;
    transform:translate3d(var(--end-x), 0, 0) scale(var(--scale)) scaleX(var(--direction));
  }
}

@keyframes akatsuki-wing{
  from{transform:rotate(-12deg);}
  to{transform:rotate(14deg);}
}

@media (max-width:720px){
  .sharingan-eye{
    --eye-size:min(42vw, 160px);
    --eye-scale:.38;
  }
}

@media print, (prefers-reduced-motion: reduce){
  .sharingan-vision{display:none !important;}
}

@media (prefers-reduced-motion: reduce){
  .akatsuki-crows{display:none !important;}
}

@media print{
  .akatsuki-crows{display:none !important;}
}

/* Mini terminal kali animé */
.terminal{
  margin-top:24px;
  background:rgba(5,7,10,.92);
  border:1px solid rgba(0,0,0,.55);
  border-radius:16px;
  padding:18px 20px 20px;
  font-family:"Fira Code", "SFMono-Regular", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size:.92rem;
  line-height:1.5;
  color:#6cfac7;
  min-height:160px;
  max-height:260px;
  box-shadow:0 16px 38px rgba(0,0,0,.45);
  overflow:auto;
  position:relative;
}

.terminal::before{
  content:"";
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:34px;
  background:linear-gradient(135deg, rgba(12,14,20,.9), rgba(18,21,28,.85));
  border-bottom:1px solid rgba(0,0,0,.55);
  box-shadow:0 6px 16px rgba(0,0,0,.35);
}

.terminal::after{
  content:"";
  position:absolute;
  top:11px;
  left:18px;
  width:46px;
  height:12px;
  border-radius:999px;
  background:radial-gradient(circle at 10% 50%, #ff5f56 0 30%, transparent 32%),
             radial-gradient(circle at 40% 50%, #ffbd2e 0 30%, transparent 32%),
             radial-gradient(circle at 70% 50%, #27c93f 0 30%, transparent 32%);
  opacity:.75;
}

.terminal-line,
.terminal-output{
  position:relative;
  z-index:1;
  white-space:pre-wrap;
  word-break:break-word;
  margin-top:6px;
}

.terminal-line:first-of-type,
.terminal-output:first-of-type{
  margin-top:40px;
}

.terminal-prompt{
  color:#7dfede;
  font-weight:600;
}

.terminal-command{
  color:#d9fff2;
}

.terminal-output{
  color:#7dfede;
  opacity:.8;
  padding-left:18px;
}

.terminal-cursor{
  display:inline-block;
  width:.6ch;
  height:1.1em;
  margin-left:4px;
  background:#6cfac7;
  animation:terminal-blink 1.05s steps(2, start) infinite;
}

@keyframes terminal-blink{
  0%,49%{opacity:1;}
  50%,100%{opacity:0;}
}

@media (max-width:720px){
  .terminal{font-size:.86rem; padding:16px 16px 18px;}
  .terminal::after{left:14px;}
}

html[data-theme="light"] .terminal{
  background:rgba(12,12,16,.92);
  border-color:rgba(26,26,36,.65);
  box-shadow:0 16px 36px rgba(110,20,28,.22);
}

html[data-theme="light"] .terminal-output{color:#8df9e2;}
